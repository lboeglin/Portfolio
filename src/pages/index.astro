---
// src/pages/index.astro
// This page exists only to redirect based on browser language.
---

<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Redirecting...</title>

    <meta http-equiv="refresh" content="0;url=/Portfolio/fr/" />

    <script is:inline>
      // 1. Configuration (must match your astro.config.mjs)
      const base = '/Portfolio';
      const defaultLocale = 'fr';
      const locales = ['fr', 'en'];

      // 2. Detect Browser Language
      // navigator.language returns codes like 'en-US' or 'fr-FR'
      const browserLang = navigator.language || navigator.userLanguage;
      const langCode = browserLang.split('-')[0]; // Take only the first part ('en' or 'fr')

      // 3. Determine Target Locale
      // If the browser language is in our list, use it. Otherwise, use default.
      const targetLocale = locales.includes(langCode) ? langCode : defaultLocale;

      // 4. Redirect
      // We use .replace() so the back button works correctly (doesn't get stuck in a loop)
      window.location.replace(`${base}/${targetLocale}/`);
    </script>
  </head>
  <body>
    <p>Redirection en cours...</p>
  </body>
</html>
